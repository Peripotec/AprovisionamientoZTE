<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Migrar Puertos</title>
  <link rel="icon" href="/img/logo.ico" type="image/x-icon">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/migrarPuertos/migrarPuertos.css">
  <!-- CodeMirror CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.9/codemirror.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.9/theme/material-darker.min.css" />
  <script src="/js/toggleMode.js"></script>
  <script src="/js/common.js"></script>
  <script src="/migrarPuertos/migrarPuertos.js"></script>
  <!-- CodeMirror JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.9/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.9/mode/javascript/javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.9/mode/xml/xml.min.js"></script>
</head>
<body style="overflow-y: scroll;">
  <!-- Contenedor principal de la página -->
  <div class="container" style="position: relative;">
    <div class="columna-izquierda">
      <div>
        <div>
          <h1 class="form-group comando">Visualizar datos procesados</h1>
        </div>
        <div>
          <textarea id="outputData" class="dark-mode-textarea" rows="29" cols="62" readonly></textarea>
        </div>
        <div>
          <button id="copyBtn" class="btn-primary">Copiar Todo el Contenido</button>
          <button id="clearOutputBtn" class="btn-primary">Limpiar Resultado</button>
        </div>
        <div>
          <h1 class="form-group comando">Líneas Erróneas</h1>
          <textarea id="errorData" class="dark-mode-textarea" rows="12" cols="62" readonly></textarea>
          <button id="clearErrorBtn" class="btn-primary">Limpiar Errores</button>
        </div>
        <div id="summary" class="form-group comando">
          <p>Resumen del procesamiento:</p>
        </div>
      </div>
    </div>
    <div class="columna-derecha">
      <!-- Título de la página -->
      <div class="header">
        <h1 class="linkztezhone">
          <span style="opacity: 0.6;">
            <a href="/main.html">Inicio</a>
          </span>
          <span style="background-color: #a6a6a6; border: 1px solid #4f4f4f; border-radius: 4px; box-shadow: 0 0 20px 5px rgba(0, 0, 0, 0.5), 0 0 20px 5px rgba(255, 255, 255, 0.5); position: relative; z-index: 2;">
            <a href="/migrarPuertos/migrarPuertos.html">Migrar Puertos</a>
          </span>
        </h1>
      </div>
      
      <!-- Contenedor de pestañas (tabs) con clase "comando" -->
      <div class="tabs-container comando">
        <button class="btn-primary tab-btn active" data-tab="tab1">Provisionar ONUs</button>
        <button class="btn-primary tab-btn" data-tab="tab2">Configurar gpon-olt</button>
        <button class="btn-primary tab-btn" data-tab="tab3">Configurar gpon-onu_1/6/</button>
      </div>
      
      <!-- Contenido de las pestañas -->
      <div class="tabcontent-container">
        <!-- TAB 1: Provisionar ONUs -->
        <div id="tab1" class="tabcontent active">
          <div class="form-group">
            <label for="placaPuerto1">Placa/Puerto (ej. 1/16):</label>
            <input type="text" id="placaPuerto1" placeholder="ej. 1/16" />
          </div>
          <div class="form-group comando">
            <h1>Datos a Ingresar - Provisionar ONUs</h1>
            <p>Ingrese datos en el formato: onu [número] type [tipo] sn [número de serie]</p>
          </div>
          <textarea id="inputData1" class="dark-mode-textarea" rows="20" cols="76" placeholder="Ejemplo:
onu 1 type ZTEG-F668 sn YYKFCA1D8473
onu 2 type ZTE-F601C sn YYKFCB278841
..."></textarea>
          <div>
            <button id="processBtn1" class="btn-primary">Procesar</button>
            <button id="clearBtn1" class="btn-primary">Limpiar</button>
          </div>
        </div>
        
        <!-- TAB 2: Configurar gpon-olt -->
        <div id="tab2" class="tabcontent">
          <div class="form-group">
            <label for="placaPuerto2">Placa/Puerto (ej. 1/16):</label>
            <input type="text" id="placaPuerto2" placeholder="ej. 1/16" />
          </div>
          <div class="form-group comando">
            <h1>Datos a Ingresar - Configurar gpon-olt</h1>
            <p>Ingrese configuración de gpon-olt en formato completo con delimitadores "!"</p>
          </div>
          <textarea id="inputData2" class="dark-mode-textarea" rows="20" cols="76" placeholder="Ejemplo:
interface gpon-olt_1/16/16
  sn-bind enable sn
  ...
!
interface gpon-olt_1/16/17
  ...
!"></textarea>
          <div>
            <button id="processBtn2" class="btn-primary">Procesar</button>
            <button id="clearBtn2" class="btn-primary">Limpiar</button>
          </div>
        </div>
        
        <!-- TAB 3: Configurar gpon-onu_1/6/ -->
        <div id="tab3" class="tabcontent">
          <div class="form-group">
            <label for="placaPuerto3">Placa/Puerto (ej. 1/16):</label>
            <input type="text" id="placaPuerto3" placeholder="ej. 1/16" />
          </div>
          <div class="form-group comando">
            <h1>Datos a Ingresar - Configurar gpon-onu_1/6/</h1>
            <p>Ingrese configuración de gpon-onu en formato completo con delimitadores "!"</p>
          </div>
          <textarea id="inputData3" class="dark-mode-textarea" rows="20" cols="76" placeholder="Ejemplo:
interface gpon-onu_1/6/16
  ...
!
interface gpon-onu_1/6/17
  ...
!"></textarea>
          <div>
            <button id="processBtn3" class="btn-primary">Procesar</button>
            <button id="clearBtn3" class="btn-primary">Limpiar</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Mensaje de copiado -->
  <div id="copyMsg" class="copiado-mensaje" style="display: none;">Comando copiado</div>
  
  <!-- Interruptor moderno para el modo oscuro/claro -->
  <div class="toggle-switch">
    <input type="checkbox" id="toggleMode" onchange="toggleDarkMode();">
    <label for="toggleMode"></label>
  </div>

  <!-- Scripts para la funcionalidad -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Inicialización de CodeMirror para cada textarea
      const editors = {
        input1: CodeMirror.fromTextArea(document.getElementById("inputData1"), {
          lineNumbers: true,
          mode: "text/plain",
          theme: "material-darker"
        }),
        input2: CodeMirror.fromTextArea(document.getElementById("inputData2"), {
          lineNumbers: true,
          mode: "text/plain",
          theme: "material-darker"
        }),
        input3: CodeMirror.fromTextArea(document.getElementById("inputData3"), {
          lineNumbers: true,
          mode: "text/plain",
          theme: "material-darker"
        }),
        output: CodeMirror.fromTextArea(document.getElementById("outputData"), {
          lineNumbers: true,
          mode: "text/plain",
          readOnly: true,
          theme: "material-darker"
        }),
        error: CodeMirror.fromTextArea(document.getElementById("errorData"), {
          lineNumbers: true,
          mode: "text/plain",
          readOnly: true,
          theme: "material-darker"
        })
      };

      // Manejar cambio de pestañas
      document.querySelectorAll('.tab-btn').forEach(button => {
        button.addEventListener('click', function() {
          document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
          document.querySelectorAll('.tabcontent').forEach(content => content.classList.remove('active'));
          this.classList.add('active');
          const tabId = this.getAttribute('data-tab');
          document.getElementById(tabId).classList.add('active');
        });
      });

      // Configurar botones de procesamiento
      document.querySelectorAll('[id^="processBtn"]').forEach(button => {
        button.addEventListener('click', function() {
          const tabNumber = this.id.replace('processBtn', '');
          const inputData = editors['input' + tabNumber].getValue();
          const placaPuerto = document.getElementById('placaPuerto' + tabNumber).value;
          const result = window.processData(tabNumber, inputData, placaPuerto);
          editors.output.setValue(result.comandos);
          editors.error.setValue(result.errores);
          document.getElementById('summary').innerHTML = `
            <p>Resumen del procesamiento:</p>
            <p>Total de líneas: ${result.total}</p>
            <p>Procesadas: ${result.procesadas}</p>
            <p>Con errores: ${result.conErrores}</p>
          `;
        });
      });

      // Configurar botones de limpieza
      document.querySelectorAll('[id^="clearBtn"]').forEach(button => {
        button.addEventListener('click', function() {
          const tabNumber = this.id.replace('clearBtn', '');
          editors['input' + tabNumber].setValue('');
          document.getElementById('placaPuerto' + tabNumber).value = '';
        });
      });

      // Configurar botón de copiar
      document.getElementById('copyBtn').addEventListener('click', function() {
        const text = editors.output.getValue();
        navigator.clipboard.writeText(text).then(() => {
          const copyMsg = document.getElementById('copyMsg');
          copyMsg.style.display = 'block';
          setTimeout(() => copyMsg.style.display = 'none', 1500);
        });
      });

      // Configurar botones de limpieza de salida y errores
      document.getElementById('clearOutputBtn').addEventListener('click', function() {
        editors.output.setValue('');
      });
      document.getElementById('clearErrorBtn').addEventListener('click', function() {
        editors.error.setValue('');
        document.getElementById('summary').innerHTML = '<p>Resumen del procesamiento:</p>';
      });
    });
  </script>
</body>
</html>